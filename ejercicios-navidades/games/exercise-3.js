const questionsType = [
    {
        title: 'Gender',
        key: 'gender',
        questions: ['Man', 'Woman']
    },
    {
        title: 'Hair Color',
        key: 'hairColor',
        questions: ['Blonde', 'Red', 'Pink', 'Brown', 'White', 'Black']
    },
    {
        title: 'Moustache',
        key: 'moustache',
        questions: ['Yes', 'No']
    },
    {
        title: 'Glasses',
        key: 'glasses',
        questions: ['Yes', 'No']
    },
    {
        title: 'Hat or Cap',
        key: 'hatOrCap',
        questions: ['Yes', 'No']
    },
    {
        title: 'Clothes color',
        key: 'clothesColor',
        questions: ['Red', 'Orange', 'Green', 'White', 'Black', 'Pink']
    },
    {
        title: 'Skin color',
        key: 'skinColor',
        questions: ['Light', 'Dark']
    },
    {
        title: 'Long Hair',
        key: 'longHair',
        questions: ['Yes', 'No']
    }
]

const persons = [
    {
        img: 'public/exercise-3/001-man.svg',
        gender: 'Man',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Red',
        skinColor: 'Light',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/002-man.svg',
        gender: 'Man',
        hairColor: 'Blonde',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Orange',
        skinColor: 'Light',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/003-man.svg',
        gender: 'Man',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Green',
        skinColor: 'Light',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/004-man.svg',
        gender: 'Man',
        hairColor: 'Blonde',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'Yes',
        clothesColor: 'Red',
        skinColor: 'Light',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/005-man.svg',
        gender: 'Man',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'White',
        skinColor: 'Light',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/006-man.svg',
        gender: 'Man',
        hairColor: 'Brown',
        moustache: 'Yes',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Green',
        skinColor: 'Light',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/007-man.svg',
        gender: 'Man',
        hairColor: 'Red',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Black',
        skinColor: 'Light',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/008-man.svg',
        gender: 'Man',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'White',
        skinColor: 'Light',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/009-man.svg',
        gender: 'Man',
        hairColor: 'Blonde',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Orange',
        skinColor: 'Light',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/010-woman.svg',
        gender: 'Woman',
        hairColor: 'Brown',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Pink',
        skinColor: 'Light',
        longHair: 'Yes'
    }, {
        img: 'public/exercise-3/011-woman.svg',
        gender: 'Woman',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Orange',
        skinColor: 'Light',
        longHair: 'Yes'
    }, {
        img: 'public/exercise-3/012-woman.svg',
        gender: 'Woman',
        hairColor: 'Red',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Black',
        skinColor: 'Light',
        longHair: 'Yes'
    }, {
        img: 'public/exercise-3/013-woman.svg',
        gender: 'Woman',
        hairColor: 'White',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Pink',
        skinColor: 'Light',
        longHair: 'Yes'
    }, {
        img: 'public/exercise-3/014-woman.svg',
        gender: 'Woman',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'White',
        skinColor: 'Light',
        longHair: 'Yes'
    }, {
        img: 'public/exercise-3/015-woman.svg',
        gender: 'Woman',
        hairColor: 'Brown',
        moustache: 'No',
        glasses: 'Yes',
        hatOrCap: 'No',
        clothesColor: 'Orange',
        skinColor: 'Light',
        longHair: 'Yes'
    }, {
        img: 'public/exercise-3/016-woman.svg',
        gender: 'Woman',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'Yes',
        clothesColor: 'Pink',
        skinColor: 'Light',
        longHair: 'Yes'
    }, {
        img: 'public/exercise-3/017-woman.svg',
        gender: 'Woman',
        hairColor: 'Blonde',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Black',
        skinColor: 'Light',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/018-man.svg',
        gender: 'Man',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'White',
        skinColor: 'Dark',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/019-man.svg',
        gender: 'Man',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Red',
        skinColor: 'Dark',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/020-man.svg',
        gender: 'Man',
        hairColor: 'Blonde',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Black',
        skinColor: 'Dark',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/021-man.svg',
        gender: 'Man',
        hairColor: 'Black',
        moustache: 'Yes',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Orange',
        skinColor: 'Dark',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/022-man.svg',
        gender: 'Man',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'Yes',
        hatOrCap: 'No',
        clothesColor: 'Black',
        skinColor: 'Dark',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/023-man.svg',
        gender: 'Man',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Orange',
        skinColor: 'Dark',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/024-man.svg',
        gender: 'Man',
        hairColor: 'Blonde',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Black',
        skinColor: 'Dark',
        longHair: 'Yes'
    }, {
        img: 'public/exercise-3/025-man.svg',
        gender: 'Man',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Red',
        skinColor: 'Dark',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/026-man.svg',
        gender: 'Man',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Red',
        skinColor: 'Dark',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/027-woman.svg',
        gender: 'Woman',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Orange',
        skinColor: 'Dark',
        longHair: 'Yes'
    }, {
        img: 'public/exercise-3/028-woman.svg',
        gender: 'Woman',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Pink',
        skinColor: 'Dark',
        longHair: 'Yes'
    }, {
        img: 'public/exercise-3/029-woman.svg',
        gender: 'Woman',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'White',
        skinColor: 'Dark',
        longHair: 'Yes'
    }, {
        img: 'public/exercise-3/030-woman.svg',
        gender: 'Woman',
        hairColor: 'Blonde',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Orange',
        skinColor: 'Dark',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/031-woman.svg',
        gender: 'Woman',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Green',
        skinColor: 'Dark',
        longHair: 'Yes'
    }, {
        img: 'public/exercise-3/032-woman.svg',
        gender: 'Woman',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'Yes',
        hatOrCap: 'No',
        clothesColor: 'Pink',
        skinColor: 'Dark',
        longHair: 'Yes'
    }, {
        img: 'public/exercise-3/033-woman.svg',
        gender: 'Woman',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Black',
        skinColor: 'Dark',
        longHair: 'Yes'
    }, {
        img: 'public/exercise-3/034-woman.svg',
        gender: 'Woman',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Pink',
        skinColor: 'Dark',
        longHair: 'Yes'
    }, {
        img: 'public/exercise-3/035-man.svg',
        gender: 'Man',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Black',
        skinColor: 'Light',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/036-man.svg',
        gender: 'Man',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'White',
        skinColor: 'Light',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/037-man.svg',
        gender: 'Man',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'Yes',
        clothesColor: 'Red',
        skinColor: 'Light',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/038-man.svg',
        gender: 'Man',
        hairColor: 'Blonde',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Black',
        skinColor: 'Light',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/039-man.svg',
        gender: 'Man',
        hairColor: 'Black',
        moustache: 'Yes',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Green',
        skinColor: 'Light',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/040-man.svg',
        gender: 'Man',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Red',
        skinColor: 'Light',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/041-man.svg',
        gender: 'Man',
        hairColor: 'Blonde',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Black',
        skinColor: 'Light',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/042-man.svg',
        gender: 'Man',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Red',
        skinColor: 'Light',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/043-woman.svg',
        gender: 'Woman',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Black',
        skinColor: 'Light',
        longHair: 'Yes'
    }, {
        img: 'public/exercise-3/044-woman.svg',
        gender: 'Woman',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'Pink',
        skinColor: 'Light',
        longHair: 'No'
    }, {
        img: 'public/exercise-3/045-woman.svg',
        gender: 'Woman',
        hairColor: 'Black',
        moustache: 'No',
        glasses: 'No',
        hatOrCap: 'No',
        clothesColor: 'White',
        skinColor: 'Light',
        longHair: 'No'
    }
]

//contador de intentos
let clues = 0;

// ! creamos el tablero de personas
// hacemos un random de los personajes, seleccionamos el 1o y volvemos a hacer random
let shuffledPersons = persons.sort((a, b) => 0.5 - Math.random());
let selected = shuffledPersons[0];

// para ver la persona seleccionada, solamente necesitas descomentar la línea siguiente
// console.log(selected)

shuffledPersons = persons.sort((a, b) => 0.5 - Math.random());

for (let i = 0; i < shuffledPersons.length; i++) {
    shuffledPersons[i].id = i;
}

// creamos las cartas con la imagen correspondiente
const board$$ = document.querySelector(".b-board-game");
const renderPersons = () => {

    for (const person of shuffledPersons) {
        
        const card$$ = document.createElement("div");
        const image$$ = document.createElement("img");
        
        image$$.src = person.img;
        image$$.className = "card";
        image$$.id = person.id;

        board$$.appendChild(card$$);
        card$$.appendChild(image$$);

        //creamos el eventListener a cada carta para poder clicarla
        image$$.addEventListener("click", clickedCard);
    }
}

//! creamos el tablero de preguntas
// seleccionamos el div donde queremos introducir las preguntas
const questionsBoard$$ = document.querySelector(".b-questions");
questionsBoard$$.className = "questionsContainer"

//creamos la función para renderizar las preguntas con sus selecciones (botones)
const renderQuestions = () => {

    for (const question of questionsType) {

        const question$$ = document.createElement("div");
        const title$$ = document.createElement("h3");

        question$$.className = "question";
        title$$.textContent = question.title;

        questionsBoard$$.appendChild(question$$);
        question$$.appendChild(title$$);

        question.questions.forEach(element => {
            const choices$$ = document.createElement("button");
            choices$$.textContent = element;
            question$$.appendChild(choices$$);

            //le ponemos un eventListener a cada botón para saber la elección del jugador
            choices$$.addEventListener("click", matchQuestion);
        });
    }
}

// seleccionamos la pregunta de la respuesta que hemos clicado en el botón
// devolvemos la KEY de la pregunta y el contenido del botón clicado
const matchQuestion = (event) => {

    // añadimos 1 intento al contador cada vez que tocamos una pista
    clues++;
    document.querySelector("[data-function='clueCount']").textContent = clues;

    const clickedButton = event.target.textContent;
    const parentQuestion = event.target.parentNode.querySelector("h3").textContent;

    let result = "";

    for (const question of questionsType){
        if (question.title === parentQuestion) {
            result = question.key;
        }
    };
    matchSelected(event, result, clickedButton);
}

//revisamos la respuesta con los atributos del personaje seleccionado
const matchSelected = (event ,result, response) => {
    console.log(result + " -- " + response)
    if (selected[result] === response){
        //! ejecutar la función para seleccionar las cartas que no coincidan
        console.log("ACIERTO !!");
        event.target.className = "disableButtonCorrect"
        correctAnswer(response, result);
    } else {
        //! ejecutar la función para seleccionar las cartas del boton clicado
        console.log("ERROR !!");
        event.target.className = "disableButtonIncorrect"
        wrongAnswer(response, result);
    }
}

// en caso de ser erronea esconde las cartas que coinciden con el botón pulsado
const wrongAnswer = (response, result) => {

    const images = document.querySelectorAll("img");
    const erased = [];

    for (const person of persons){
        if (person[result] === response){
            erased.push(person.id);
        }
    }
    for (let i = 0; i < erased.length; i++) {
        document.getElementById(erased[i]).classList.add("cardDisabled");
    }
}

// en caso de ser correcta seleccionamos las demás cartas y las escondemos
// dejando así habilitadas las correctas
const correctAnswer = (response, result) => {

    const images = document.querySelectorAll("img");
    const erased = [];

    for (const person of persons){
        if (person[result] !== response){
            erased.push(person.id);
        }
    }
    for (let i = 0; i < erased.length; i++) {
        document.getElementById(erased[i]).classList.add("cardDisabled");
    }
}

// comprovamos el click si es la persona seleccionada o si no lo es
// siempre que se clique se deshabilitan todas las cartas
// seguido a esto, nos indica la carta en verde si es correcta
// o en rojo si es incorrecta. Mostramos un alert con el mensaje final.
// El juego se reiniciará un instante después de pulsar el botón del alert

const clickedCard = (event) => {
    const images = document.querySelectorAll("img");
    for (const img of images){
        img.classList.add("cardDisabled");
    }

    if (event.target.id == selected.id) {
        event.target.classList.add("correctCard");
            setTimeout(() => {
                alert(`     🎊 ACERTASTE 🎊
                Gastaste un total de ${clues} pistas
                El juego se reiniciará en 2 segundos después
                de que pulses este botón`);
                setTimeout(() => {
                    location.reload(); 
                }, 2000);
            }, 1000);
    } else {
        event.target.classList.add("errorCard");
            setTimeout(() => {
                alert(`     😵 YOU LOSE 😵
                El juego se reiniciará en 2 segundos después
                de que pulses este botón`);
                setTimeout(() => {
                    location.reload();        
                }, 2000);
            }, 1000);    
    }
}

window.onload = renderPersons(), renderQuestions();